export const marketData = {
  markets: ['Switzerland', 'CS', 'Portugal', 'Belgium', 'Nordics', 'Spain', 'UK', 'France', 'Italy', 'Netherlands'],
  attributes: [
    'Performance and Speed',
    'Battery Technology and Range',
    'Charging Infrastructure',
    'Noise Reduction',
    'Affordability and Cost of Ownership',
    'Insurance and Financing Options',
    'Resale Value and Longevity',
    'Government Incentives and Regulations',
    'Advanced Technology Integration',
    'Connectivity and Smart Features',
    'Safety Features',
    'After-Sales Support and Service Network',
    'Education and Awareness',
    'Urban Mobility Solutions',
    'Sustainability and Environmental Impact',
    'Market Segmentation',
    'Brand Heritage and Trust',
    'Community and Culture',
    'Customization and Personalization',
    'Design Innovation'
  ],
  // Raw WRI scores
  scores: {
    'Performance and Speed': {
      'Switzerland': 85.0, 'CS': 88.0, 'Portugal': 83.0, 'Belgium': 84.0, 
      'Nordics': 82.5, 'Spain': 88.0, 'UK': 88.5, 'France': 88.0, 'Italy': 93.0,
      'Netherlands': 86.5
    },
    'Battery Technology and Range': {
      'Switzerland': 95.0, 'CS': 95.0, 'Portugal': 95.0, 'Belgium': 92.0,
      'Nordics': 95.0, 'Spain': 95.0, 'UK': 95.0, 'France': 95.0, 'Italy': 93.0,
      'Netherlands': 94.0
    },
    'Charging Infrastructure': {
      'Switzerland': 85.0, 'CS': 88.5, 'Portugal': 87.0, 'Belgium': 82.0,
      'Nordics': 85.0, 'Spain': 85.0, 'UK': 88.5, 'France': 88.5, 'Italy': 83.0,
      'Netherlands': 89.5
    },
    'Noise Reduction': {
      'Switzerland': 45.0, 'CS': 56.5, 'Portugal': 42.5, 'Belgium': 48.5,
      'Nordics': 50.5, 'Spain': 48.5, 'UK': 53.5, 'France': 56.5, 'Italy': 58.0,
      'Netherlands': 52.0
    },
    'Affordability and Cost of Ownership': {
      'Switzerland': 90.0, 'CS': 95.0, 'Portugal': 93.0, 'Belgium': 91.0,
      'Nordics': 91.5, 'Spain': 95.0, 'UK': 95.0, 'France': 95.0, 'Italy': 95.0,
      'Netherlands': 93.5
    },
    'Insurance and Financing Options': {
      'Switzerland': 25.0, 'CS': 30.0, 'Portugal': 20.0, 'Belgium': 30.0,
      'Nordics': 23.5, 'Spain': 31.0, 'UK': 36.0, 'France': 30.0, 'Italy': 30.0,
      'Netherlands': 32.5
    },
    'Resale Value and Longevity': {
      'Switzerland': 55.0, 'CS': 63.0, 'Portugal': 64.5, 'Belgium': 59.5,
      'Nordics': 59.5, 'Spain': 58.0, 'UK': 58.0, 'France': 63.0, 'Italy': 64.5,
      'Netherlands': 61.0
    },
    'Government Incentives and Regulations': {
      'Switzerland': 65.0, 'CS': 62.0, 'Portugal': 87.0, 'Belgium': 70.5,
      'Nordics': 78.0, 'Spain': 84.0, 'UK': 70.0, 'France': 72.0, 'Italy': 59.0,
      'Netherlands': 82.5
    },
    'Advanced Technology Integration': {
      'Switzerland': 70.0, 'CS': 76.0, 'Portugal': 56.0, 'Belgium': 52.5,
      'Nordics': 63.0, 'Spain': 71.5, 'UK': 74.0, 'France': 76.0, 'Italy': 78.5,
      'Netherlands': 75.0
    },
    'Connectivity and Smart Features': {
      'Switzerland': 35.0, 'CS': 63.0, 'Portugal': 28.0, 'Belgium': 33.0,
      'Nordics': 41.5, 'Spain': 52.0, 'UK': 56.0, 'France': 63.0, 'Italy': 68.5,
      'Netherlands': 58.5
    },
    'Safety Features': {
      'Switzerland': 10.0, 'CS': 30.0, 'Portugal': 13.0, 'Belgium': 18.0,
      'Nordics': 22.0, 'Spain': 23.5, 'UK': 28.5, 'France': 30.0, 'Italy': 30.0,
      'Netherlands': 25.5
    },
    'After-Sales Support and Service Network': {
      'Switzerland': 65.0, 'CS': 60.0, 'Portugal': 62.5, 'Belgium': 81.5,
      'Nordics': 72.5, 'Spain': 81.0, 'UK': 67.0, 'France': 60.0, 'Italy': 59.5,
      'Netherlands': 71.0
    },
    'Education and Awareness': {
      'Switzerland': 50.0, 'CS': 52.0, 'Portugal': 67.5, 'Belgium': 58.5,
      'Nordics': 52.0, 'Spain': 55.5, 'UK': 55.0, 'France': 52.0, 'Italy': 54.5,
      'Netherlands': 56.5
    },
    'Urban Mobility Solutions': {
      'Switzerland': 85.0, 'CS': 91.5, 'Portugal': 74.5, 'Belgium': 74.0,
      'Nordics': 70.5, 'Spain': 86.5, 'UK': 85.0, 'France': 91.5, 'Italy': 91.5,
      'Netherlands': 88.0
    },
    'Sustainability and Environmental Impact': {
      'Switzerland': 45.0, 'CS': 50.0, 'Portugal': 42.5, 'Belgium': 45.0,
      'Nordics': 63.0, 'Spain': 51.5, 'UK': 50.0, 'France': 49.0, 'Italy': 51.0,
      'Netherlands': 64.5
    },
    'Market Segmentation': {
      'Switzerland': 70.0, 'CS': 74.0, 'Portugal': 78.0, 'Belgium': 80.0,
      'Nordics': 75.0, 'Spain': 75.0, 'UK': 75.0, 'France': 74.0, 'Italy': 77.0,
      'Netherlands': 76.5
    },
    'Brand Heritage and Trust': {
      'Switzerland': 70.0, 'CS': 72.0, 'Portugal': 75.0, 'Belgium': 73.0,
      'Nordics': 74.0, 'Spain': 75.0, 'UK': 75.0, 'France': 74.0, 'Italy': 76.0,
      'Netherlands': 75.0
    },
    'Community and Culture': {
      'Switzerland': 45.0, 'CS': 48.0, 'Portugal': 50.0, 'Belgium': 47.0,
      'Nordics': 49.0, 'Spain': 50.0, 'UK': 50.0, 'France': 49.0, 'Italy': 51.0,
      'Netherlands': 50.0
    },
    'Customization and Personalization': {
      'Switzerland': 20.0, 'CS': 22.0, 'Portugal': 25.0, 'Belgium': 23.0,
      'Nordics': 24.0, 'Spain': 25.0, 'UK': 25.0, 'France': 24.0, 'Italy': 26.0,
      'Netherlands': 25.0
    },
    'Design Innovation': {
      'Switzerland': 70.0, 'CS': 72.0, 'Portugal': 74.0, 'Belgium': 73.0,
      'Nordics': 73.0, 'Spain': 74.0, 'UK': 74.0, 'France': 73.0, 'Italy': 75.0,
      'Netherlands': 74.0
    }
  },
  // Calculate deviations from the mean for each attribute-market combination
  get deviations() {
    const deviations = {};
    
    // For each attribute
    for (const attribute of this.attributes) {
      deviations[attribute] = {};
      
      // Calculate mean for this attribute
      const scores = Object.values(this.scores[attribute]);
      const mean = scores.reduce((a, b) => a + b, 0) / scores.length;
      
      // Calculate deviation for each market
      for (const market of this.markets) {
        const score = this.scores[attribute][market];
        deviations[attribute][market] = score - mean;
      }
    }
    
    return deviations;
  },
  topResonance: [
    { 
      attribute: 'Affordability and Cost of Ownership',
      score: 95.0,
      reasoning: 'Most critical factor across markets, primarily acting as a barrier to adoption'
    },
    { 
      attribute: 'Battery Technology and Range',
      score: 94.5,
      reasoning: 'Range anxiety and battery performance are top concerns affecting purchase decisions'
    },
    { 
      attribute: 'Performance and Speed',
      score: 89.4,
      reasoning: 'Key driver of interest and excitement, especially instant torque and acceleration'
    },
    { 
      attribute: 'Urban Mobility Solutions',
      score: 88.6,
      reasoning: 'Defines core use case and value proposition for electric motorcycles'
    },
    { 
      attribute: 'Charging Infrastructure',
      score: 86.3,
      reasoning: 'Critical enabler/barrier for adoption, especially for non-urban use'
    }
  ],
  strategicDirection: {
    positioning: "Position BMW electric motorcycles as premium urban mobility solutions with exceptional performance, emphasizing the CE 04 for city use and upcoming models for broader applications. Focus on overcoming key barriers while highlighting performance advantages.",
    messaging: "Emphasize instant torque and acceleration, premium technology integration, and urban agility. Address range concerns transparently and highlight charging solutions. Build confidence in the established dealer network and after-sales support.",
    opportunities: "Leverage strong performance scores and urban mobility appeal. Create compelling narratives around the community aspect of riding. Develop innovative financing solutions to address the cost barrier.",
    considerations: "Actively address and mitigate concerns about range limitations, charging infrastructure, and high initial costs. Maintain focus on urban use cases while developing solutions for broader applications."
  }
};

// Helper function to calculate market average for an attribute
const getMarketAverage = (attribute) => {
  const markets = Object.values(marketData.deviations[attribute]);
  return markets.reduce((a, b) => a + b, 0) / markets.length;
};

// Calculate deviations from market average
export const getHighestDeviations = () => {
  const deviations = [];
  Object.entries(marketData.deviations).forEach(([attribute, markets]) => {
    const avg = getMarketAverage(attribute);
    Object.entries(markets).forEach(([market, value]) => {
      deviations.push({
        attribute,
        market,
        value: value - avg,
        absoluteValue: Math.abs(value - avg)
      });
    });
  });
  return deviations
    .sort((a, b) => b.absoluteValue - a.absoluteValue)
    .slice(0, 5);
};

export const getLowestDeviations = () => {
  const deviations = [];
  Object.entries(marketData.deviations).forEach(([attribute, markets]) => {
    const avg = getMarketAverage(attribute);
    Object.entries(markets).forEach(([market, value]) => {
      deviations.push({
        attribute,
        market,
        value: value - avg,
        absoluteValue: Math.abs(value - avg)
      });
    });
  });
  return deviations
    .sort((a, b) => a.absoluteValue - b.absoluteValue)
    .slice(0, 5);
}; 